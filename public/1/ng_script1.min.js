dataApp.controller("plateCtrl",function($scope,$http,vcRecaptchaService,ngPlate){$scope.vehicles=[],$scope.response=null,$scope.widgetId=null,$scope.setResponse=function(response,immatriculation,uidplate){$http({method:"GET",url:shopConf.host.baseUri+"/wsCaller/selectorplate",params:{immatriculation:immatriculation,captcha_token:response,family_id:family_id,generic_id:generic_id,locale:shopConf.locale,device:plateDevice}}).then(function(response){""!==response.data&&null!=response.data.vehicule?$scope.vehicles=response.data.vehicule:$scope.vehicles=[],$scope.manageVinAndPlate=function(index){if(angular.isDefined(response.data.vin)&&null!==response.data.vin){var vins=response.data.vin.split("|");setCookie("vin",vins[index],100),dataLayer[0].eligible_testab_vin=vins[index]}if(angular.isDefined(response.data.vin_associate_ktype)&&null!==response.data.vin_associate_ktype){var vins_associate_ktype=response.data.vin_associate_ktype.split("|");setCookie("vin_associate_ktype",vins_associate_ktype[index],100)}dataLayer[0].license_plate=immatriculation},$("#plateVehicles"+uidplate).modal()})},$scope.setWidgetId=function(widgetId){$scope.widgetId=widgetId},$scope.cbExpiration=function(){vcRecaptchaService.reload($scope.widgetId),$scope.response=null},$scope.plateSubmit=function(immatriculation,uidplate){ngPlate.captchaIsRequired(function(isRequired){isRequired?(vcRecaptchaService.reload($scope.widgetId),vcRecaptchaService.execute($scope.widgetId)):$scope.setResponse(null,immatriculation,uidplate)})}});